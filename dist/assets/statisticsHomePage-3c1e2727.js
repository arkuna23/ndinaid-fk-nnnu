import {
    p as Ra,
    T as Da,
    e as ya,
    r as _,
    U as Ea,
    f as Ja,
    o as C,
    c as T,
    t as a,
    B as m,
    a as l,
    k as r,
    l as c,
    v as S,
    z as La,
    C as ka,
    D as Ia,
    m as U,
    _ as qa,
    J as Ga,
    ad as Oa,
    L as Ka,
    ae as Wa,
    aU as Xa,
    R as Ya,
    S as Za,
    __tla as $a
} from "./index-6c08ea4c.js";

import {
    _ as ae,
    __tla as ee
} from "./index-c4ca0ced.js";

import {
    _ as te,
    __tla as le
} from "./index-1024512a.js";

import {
    q as re,
    t as se,
    h as oe,
    v as ga,
    w as ne,
    x as ie,
    y as ce,
    __tla as ue
} from "./assignmentAndAssessment-58199f67.js";

import {
    s as _e,
    __tla as me
} from "./file-e038b35d.js";

import {
    f as Ca,
    d as xa,
    __tla as pe
} from "./formatTime-de6f1520.js";

import de, {
    __tla as fe
} from "./paperMarking-42b2a162.js";

import {
    _ as ve
} from "./_plugin-vue_export-helper-1b428a4d.js";

import {
    __tla as be
} from "./index-993301ca.js";

import "./tree-05ea8e09.js";

import {
    __tla as he
} from "./DeptTag-1be092ce.js";

import {
    __tla as Se
} from "./index-ef4d146e.js";

import {
    __tla as ye
} from "./el-drawer-fca4d971.js";

import {
    __tla as ke
} from "./DictTag.vue_vue_type_script_lang-bb90acfe.js";

import "./color-a8b4eb58.js";

import {
    __tla as Ie
} from "./dict-c5825220.js";

import {
    __tla as ge
} from "./largeQuestionPreview-4cf8d32b.js";

import {
    __tla as Ce
} from "./type10-3a7bc4b8.js";

import {
    __tla as xe
} from "./type1-d1c988fe.js";

import {
    __tla as we
} from "./type2-939c8380.js";

import {
    __tla as Fe
} from "./type3-88dc6364.js";

import {
    __tla as je
} from "./type4-a9d5770c.js";

import {
    __tla as Ne
} from "./type5-eee3ae6c.js";

import "./keyboardDisable-3c8e0d58.js";

import {
    __tla as ze
} from "./type6-c80fcdf9.js";

import {
    __tla as Qe
} from "./type7-52b282a4.js";

import {
    __tla as Te
} from "./video-1d0dc730.js";

import {
    __tla as Ue
} from "./type20-d132236e.js";

import {
    __tla as Pe
} from "./myQuestionBank-a9dcc9db.js";

import {
    __tla as Ve
} from "./type30-d500a30b.js";

import "./el-collapse-transition-4ed993c7.js";

import {
    __tla as He
} from "./sqlDetail-47f64ae5.js";

import {
    __tla as Be
} from "./markCounterByQuestion-eb786129.js";

let wa, Me = Promise.all([ (() => {
    try {
        return $a;
    } catch {}
})(), (() => {
    try {
        return ee;
    } catch {}
})(), (() => {
    try {
        return le;
    } catch {}
})(), (() => {
    try {
        return ue;
    } catch {}
})(), (() => {
    try {
        return me;
    } catch {}
})(), (() => {
    try {
        return pe;
    } catch {}
})(), (() => {
    try {
        return fe;
    } catch {}
})(), (() => {
    try {
        return be;
    } catch {}
})(), (() => {
    try {
        return he;
    } catch {}
})(), (() => {
    try {
        return Se;
    } catch {}
})(), (() => {
    try {
        return ye;
    } catch {}
})(), (() => {
    try {
        return ke;
    } catch {}
})(), (() => {
    try {
        return Ie;
    } catch {}
})(), (() => {
    try {
        return ge;
    } catch {}
})(), (() => {
    try {
        return Ce;
    } catch {}
})(), (() => {
    try {
        return xe;
    } catch {}
})(), (() => {
    try {
        return we;
    } catch {}
})(), (() => {
    try {
        return Fe;
    } catch {}
})(), (() => {
    try {
        return je;
    } catch {}
})(), (() => {
    try {
        return Ne;
    } catch {}
})(), (() => {
    try {
        return ze;
    } catch {}
})(), (() => {
    try {
        return Qe;
    } catch {}
})(), (() => {
    try {
        return Te;
    } catch {}
})(), (() => {
    try {
        return Ue;
    } catch {}
})(), (() => {
    try {
        return Pe;
    } catch {}
})(), (() => {
    try {
        return Ve;
    } catch {}
})(), (() => {
    try {
        return He;
    } catch {}
})(), (() => {
    try {
        return Be;
    } catch {}
})() ]).then(async () => {
    let d, P, V, H, B, M, A, R, D, E, J, L, q, G, O, K, W, X, Y, Z, $, aa, ea, ta, la, ra, sa, oa, na, ia, ca, ua, _a, ma;
    d = x => (Ya("data-v-9aa51b0e"), x = x(), Za(), x), P = {
        class: "detailsContainer"
    }, V = {
        class: "detailsInfoContainer"
    }, H = {
        class: "cellContainer"
    }, B = {
        class: "examName"
    }, M = {
        class: "classAndGrade"
    }, A = {
        class: "cellContainer"
    }, R = {
        class: "infoItem"
    }, D = d(() => a("span", {
        class: "info-label"
    }, "开始时间：", -1)), E = {
        class: "info-value"
    }, J = {
        class: "infoItem"
    }, L = d(() => a("span", {
        class: "info-label"
    }, "截止时间：", -1)), q = {
        class: "info-value"
    }, G = {
        class: "infoItem"
    }, O = d(() => a("span", {
        class: "info-label"
    }, "未提交：", -1)), K = {
        class: "info-value redFont"
    }, W = {
        class: "infoItem"
    }, X = d(() => a("span", {
        class: "info-label"
    }, "已提交：", -1)), Y = {
        class: "info-value greenFont"
    }, Z = {
        class: "infoItem"
    }, $ = d(() => a("span", {
        class: "info-label"
    }, "待批阅：", -1)), aa = {
        class: "info-value yellowFont"
    }, ea = {
        class: "tableContainer"
    }, ta = {
        class: "operatingArea"
    }, la = {
        class: "btnContainer"
    }, ra = {
        class: "tableInfo"
    }, sa = {
        key: 1
    }, oa = {
        class: "mb10"
    }, na = {
        class: "recordHeadInfo"
    }, ia = d(() => a("span", {
        class: "headInfo-label"
    }, "学生姓名：", -1)), ca = {
        class: "headInfo-value"
    }, ua = {
        class: "recordHeadInfo"
    }, _a = d(() => a("span", {
        class: "headInfo-label"
    }, "学号：", -1)), ma = {
        class: "headInfo-value"
    }, wa = ve({
        __name: "statisticsHomePage",
        setup(x) {
            Ra();
            const pa = Da(), j = ya(() => pa.params.teachClassId), y = ya(() => pa.params.testId), N = _(!1), n = _({}), h = _(!1), da = _(0), f = _([]), fa = _({}), k = _(!1), I = _({}), va = _([]), z = _("0"), Fa = _([ {
                label: "未提交",
                value: 0
            }, {
                label: "已提交",
                value: 2
            } ]), ja = _([ {
                label: "待批阅",
                value: 0
            }, {
                label: "已批阅",
                value: 1
            } ]), Na = [ {
                label: "提交状态",
                key: "submitStatus",
                type: "list",
                options: Fa.value
            }, {
                label: "批阅状态",
                key: "markStatus",
                type: "list",
                options: ja.value
            } ], u = Ea({
                submitStatus: "",
                markStatus: "",
                nickName: "",
                scoreSort: 0,
                pageNo: 1,
                pageSize: 10
            }), za = s => {
                u.submitStatus = s.submitStatus, u.markStatus = s.markStatus, u.nickName = s.name, 
                w();
            }, w = () => {
                let s = {
                    testId: y.value,
                    teachClassId: j.value,
                    ...u,
                    pageNo: u.pageNo - 1
                };
                se(s).then(e => {
                    var p;
                    f.value = e, da.value = ((p = e.studentPage) == null ? void 0 : p.totalElements) || 0;
                });
            }, Qa = () => {
                let s = {
                    testId: y.value,
                    teachClassId: j.value,
                    submitStatus: u.submitStatus,
                    markStatus: u.markStatus,
                    nickName: u.nickName,
                    scoreSort: u.scoreSort
                };
                oe(s).then(e => {
                    _e(e, e.fileName || "成绩.xls");
                });
            }, Ta = () => {
                I.value = {};
            }, F = () => {
                [ null, "", 0, 0 ].includes(n.value.finalScore) && (n.value.finalScore = (parseFloat(n.value.subjectiveScore || 0) + parseFloat(n.value.objectiveScore || 0)).toFixed(1));
            }, Ua = s => {
                ga(s).then(e => {
                    n.value = {
                        ...e,
                        ...s
                    }, F();
                });
            }, Pa = s => {
                if (!n.value || !Object.keys(n.value).length) return;
                const {
                    subjectiveScore: e,
                    finalScore: p,
                    objectiveScore: Q
                } = n.value || {};
                let o = {
                    subjectiveScore: parseFloat(e || 0),
                    finalScore: parseFloat(p || 0),
                    objectiveScore: parseFloat(Q || 0)
                }, i = s.newCandidateScore - s.oldCandidateScore;
                s.type === 1 && (o.objectiveScore = Math.max(0, parseFloat(o.objectiveScore || "0") + i), 
                o.objectiveScore = parseFloat(o.objectiveScore.toFixed(1))), o.finalScore = Math.max(0, parseFloat(o.finalScore || "0") + i), 
                o.finalScore = parseFloat(o.finalScore.toFixed(1)), isNaN(o.finalScore) && (o.finalScore = 0), 
                n.value.subjectiveScore = o.objectiveScore, n.value.finalScore = o.finalScore, 
                n.value.objectiveScore = o.objectiveScore;
            }, Va = () => {
                h.value = !1, n.value = {}, w();
            }, Ha = s => {
                let e = {
                    number: s.number,
                    testId: y.value
                };
                ce(e).then(p => {
                    p.paperParts && (n.value = {
                        ...p,
                        ...e
                    }, F());
                });
            };
            return Ja(() => {
                w(), re(j.value).then(s => {
                    fa.value = s;
                });
            }), (s, e) => {
                var ha;
                const p = te, Q = qa, o = Ga, i = Oa, Ba = Ka, ba = Wa, Ma = ae, Aa = Xa;
                return C(), T("div", P, [ a("div", V, [ a("div", H, [ a("span", B, m(l(f).testName ?? "--"), 1), a("span", M, m(l(fa).name ?? "--"), 1) ]), a("div", A, [ a("div", null, [ a("span", R, [ D, a("span", E, m(l(Ca)(l(f).startTime) ?? "--"), 1) ]), a("span", J, [ L, a("span", q, m(l(Ca)(l(f).endTime) ?? "--"), 1) ]) ]), a("div", null, [ a("span", G, [ O, a("span", K, m(l(f).notSubmittedQty ?? "0"), 1) ]), a("span", W, [ X, a("span", Y, m(l(f).submittedQty ?? "0"), 1) ]), a("span", Z, [ $, a("span", aa, m(l(f).waitingMarkQty ?? "0"), 1) ]) ]) ]) ]), a("div", ea, [ a("div", ta, [ r(p, {
                    ref: "ComSearchRef",
                    borderBox: !0,
                    keywordsInfo: {
                        label: "测验名称/测验标签",
                        key: "name"
                    },
                    searchList: Na,
                    onHandleSearch: za
                }, null, 512), a("div", la, [ r(o, {
                    size: "large",
                    type: "primary",
                    onClick: Qa
                }, {
                    default: c(() => [ r(Q, {
                        class: "mr5",
                        icon: "svg-icon:icon-export"
                    }), S(" 导出成绩 ") ]),
                    _: 1
                }) ]) ]), a("div", ra, [ r(ba, {
                    data: ((ha = l(f).studentPage) == null ? void 0 : ha.content) || [],
                    height: "450px"
                }, {
                    default: c(() => [ r(i, {
                        label: "序号",
                        type: "index",
                        width: "80",
                        align: "center"
                    }), r(i, {
                        label: "学生姓名",
                        prop: "nickName"
                    }), r(i, {
                        label: "工号/学号",
                        prop: "number"
                    }), r(i, {
                        label: "提交状态",
                        prop: "submitStatus"
                    }, {
                        default: c(t => [ r(Ba, {
                            type: t.row.submitStatus === 0 ? "danger" : "success"
                        }, {
                            default: c(() => [ S(m(t.row.submitStatus === 0 ? "未提交" : "已提交"), 1) ]),
                            _: 2
                        }, 1032, [ "type" ]) ]),
                        _: 1
                    }), r(i, {
                        label: "批阅状态",
                        prop: "markStatus"
                    }, {
                        default: c(t => [ t.row.submitStatus !== 0 ? (C(), T("span", {
                            key: 0,
                            class: La([ {
                                [t.row.markStatus === 0 ? "unread" : "haveReviewed"]: !0
                            }, "circleSpan" ])
                        }, m(t.row.markStatus === 0 ? "待批阅" : "已批阅"), 3)) : (C(), 
                        T("span", sa, "--")) ]),
                        _: 1
                    }), r(i, {
                        label: "提交时间",
                        prop: "submitTime",
                        formatter: l(xa)
                    }, null, 8, [ "formatter" ]), r(i, {
                        label: "最终得分",
                        prop: "finalScore"
                    }), r(i, {
                        label: "操作",
                        align: "center",
                        width: "180",
                        fixed: "right"
                    }, {
                        default: c(t => [ t.row.submitStatus !== 0 ? (C(), ka(o, {
                            key: 0,
                            type: "text",
                            size: "small",
                            onClick: Sa => (v => {
                                let b = {
                                    testId: y.value,
                                    candidateId: v.candidateId,
                                    historyId: v.historyId,
                                    objectiveQuestionFlag: !1
                                };
                                ga(b).then(g => {
                                    h.value = !0, z.value = "0", n.value = {
                                        ...g,
                                        ...b
                                    }, F();
                                });
                            })(t.row)
                        }, {
                            default: c(() => [ S(" 批阅 ") ]),
                            _: 2
                        }, 1032, [ "onClick" ])) : Ia("", !0), t.row.markStatus !== 0 ? (C(), 
                        ka(o, {
                            key: 1,
                            type: "text",
                            size: "small",
                            onClick: Sa => (v => {
                                let b = {
                                    candidateId: v.candidateId,
                                    sort: 1
                                };
                                ne(b).then(g => {
                                    va.value = g, k.value = !0, I.value = v || {};
                                });
                            })(t.row)
                        }, {
                            default: c(() => [ S(" 提交记录 ") ]),
                            _: 2
                        }, 1032, [ "onClick" ])) : Ia("", !0) ]),
                        _: 1
                    }) ]),
                    _: 1
                }, 8, [ "data" ]), r(Ma, {
                    limit: l(u).size,
                    "onUpdate:limit": e[0] || (e[0] = t => l(u).size = t),
                    page: l(u).page,
                    "onUpdate:page": e[1] || (e[1] = t => l(u).page = t),
                    total: l(da),
                    onPagination: e[2] || (e[2] = t => w())
                }, null, 8, [ "limit", "page", "total" ]) ]) ]), r(Aa, {
                    title: "提交记录",
                    modelValue: l(k),
                    "onUpdate:modelValue": e[4] || (e[4] = t => U(k) ? k.value = t : null),
                    width: "500px",
                    onClose: Ta
                }, {
                    footer: c(() => [ r(o, {
                        onClick: e[3] || (e[3] = t => k.value = !1)
                    }, {
                        default: c(() => [ S("关 闭") ]),
                        _: 1
                    }) ]),
                    default: c(() => [ a("div", oa, [ a("span", na, [ ia, a("span", ca, m(l(I).nickName), 1) ]), a("span", ua, [ _a, a("span", ma, m(l(I).number), 1) ]) ]), a("div", null, [ r(ba, {
                        data: l(va),
                        height: "300px"
                    }, {
                        default: c(() => [ r(i, {
                            label: "序号",
                            type: "index",
                            width: "80",
                            align: "center"
                        }), r(i, {
                            label: "提交时间",
                            prop: "submitTime",
                            formatter: l(xa)
                        }, null, 8, [ "formatter" ]), r(i, {
                            label: "最终得分",
                            prop: "finalScore"
                        }), r(i, {
                            label: "操作",
                            align: "center",
                            width: "120",
                            fixed: "right"
                        }, {
                            default: c(t => [ r(o, {
                                type: "text",
                                size: "small",
                                onClick: Sa => (v => {
                                    let b = {
                                        testId: y.value,
                                        candidateId: v.candidateId,
                                        historyId: I.value.historyId,
                                        objectiveQuestionFlag: !0
                                    };
                                    ie(b).then(g => {
                                        h.value = !0, z.value = "3", n.value = {
                                            ...g,
                                            ...b
                                        }, F();
                                    });
                                })(t.row)
                            }, {
                                default: c(() => [ S(" 详情 ") ]),
                                _: 2
                            }, 1032, [ "onClick" ]) ]),
                            _: 1
                        }) ]),
                        _: 1
                    }, 8, [ "data" ]) ]) ]),
                    _: 1
                }, 8, [ "modelValue" ]), r(de, {
                    modelValue: l(h),
                    "onUpdate:modelValue": e[5] || (e[5] = t => U(h) ? h.value = t : null),
                    markType: l(z),
                    form: l(n),
                    objectiveQuestionFlag: l(N),
                    "onUpdate:objectiveQuestionFlag": e[6] || (e[6] = t => U(N) ? N.value = t : null),
                    onSwitchChange: Ua,
                    onComputedScore: Pa,
                    onHandleBack: Va,
                    onSubmitAndContinue: Ha
                }, null, 8, [ "modelValue", "markType", "form", "objectiveQuestionFlag" ]) ]);
            };
        }
    }, [ [ "__scopeId", "data-v-9aa51b0e" ] ]);
});

export {
    Me as __tla,
    wa as default
};