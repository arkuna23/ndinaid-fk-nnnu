import {
    r as y,
    b8 as tt,
    e as B,
    u as rt,
    p as st,
    w as de,
    U as lt,
    a0 as nt,
    a as t,
    n as G,
    o as b,
    c as E,
    k as m,
    l as v,
    C as R,
    D as T,
    H as be,
    t as p,
    v as Q,
    dY as qe,
    dZ as ot,
    m as j,
    d_ as it,
    B as L,
    F as Sa,
    y as Ta,
    z as ut,
    dW as xe,
    cg as Qe,
    P as pt,
    O as dt,
    cK as ct,
    Q as _t,
    J as mt,
    _ as vt,
    R as yt,
    S as ft,
    __tla as ht
} from "./index-6c08ea4c.js";

import {
    E as gt,
    __tla as bt
} from "./el-drawer-fca4d971.js";

import {
    h as qt,
    a as xt,
    b as Qt
} from "./keyboardDisable-3c8e0d58.js";

import {
    d as Pt,
    D as wt,
    __tla as kt
} from "./dict-c5825220.js";

import St, {
    __tla as Tt
} from "./randomService-761e9983.js";

import It, {
    __tla as Ct
} from "./chooseTags-11285796.js";

import Et, {
    __tla as Lt
} from "./batchEntry-8004f6eb.js";

import Nt, {
    __tla as Ot
} from "./libraryPreview-b159731a.js";

import Vt, {
    __tla as Bt
} from "./largeQuestion-c60044ae.js";

import Rt, {
    __tla as jt
} from "./questionItems-cc403f96.js";

import Ft, {
    __tla as Dt
} from "./chooseQuestion-a0799ec7.js";

import Mt, {
    __tla as Ut
} from "./setScore-5ccc198a.js";

import {
    M as ce,
    __tla as $t
} from "./rulemaking-fae7d850.js";

import {
    e as zt,
    __tla as At
} from "./selectCourseResourcePackageQuestion.vue_vue_type_style_index_0_scoped_270afb37_lang-ab43f27d.js";

import {
    _ as Ht,
    __tla as Jt
} from "./viewDatabase.vue_vue_type_script_setup_true_lang-a51e8548.js";

import {
    u as Yt,
    __tla as Gt
} from "./assignmentAndAssessment-58199f67.js";

import {
    _ as Kt
} from "./_plugin-vue_export-helper-1b428a4d.js";

import {
    a as Zt,
    b as Wt,
    E as Xt,
    __tla as er
} from "./index-5adb716b.js";

import {
    __tla as ar
} from "./questionBank-6fe58de9.js";

import {
    __tla as tr
} from "./DictTag.vue_vue_type_script_lang-bb90acfe.js";

import "./color-a8b4eb58.js";

import {
    __tla as rr
} from "./questionPreview-3c0f3206.js";

import {
    __tla as sr
} from "./type1-bb9ab50e.js";

import {
    __tla as lr
} from "./type2-f7593207.js";

import {
    __tla as nr
} from "./type3-f0157d42.js";

import {
    __tla as or
} from "./type4-e194cfc5.js";

import {
    __tla as ir
} from "./type5-5cfc2694.js";

import {
    __tla as ur
} from "./type6-f24b6333.js";

import {
    __tla as pr
} from "./type7-6a71ebde.js";

import {
    __tla as dr
} from "./video-1d0dc730.js";

import {
    __tla as cr
} from "./file-e038b35d.js";

import {
    __tla as _r
} from "./type20-1bb6de92.js";

import {
    __tla as mr
} from "./type30-1635403c.js";

import {
    __tla as vr
} from "./myQuestionBank-a9dcc9db.js";

import {
    __tla as yr
} from "./intelligentEntry-adfd5635.js";

import {
    __tla as fr
} from "./largeQuestionPreview-0d03e5d2.js";

import {
    __tla as hr
} from "./Editor.vue_vue_type_style_index_1_scoped_83b80ee8_lang-964690b9.js";

import {
    __tla as gr
} from "./style.css_vue_type_style_index_0_src_true_lang-90967dd2.js";

import "./editEditor.vue_vue_type_style_index_0_scoped_bf777343_lang-f0d79ba2.js";

import {
    __tla as br
} from "./index-c4ca0ced.js";

import {
    __tla as qr
} from "./index-993301ca.js";

import {
    __tla as xr
} from "./sqlDetail-6033fcff.js";

import {
    __tla as Qr
} from "./questionInfo-7ad6a9af.js";

import {
    __tla as Pr
} from "./type1-81e690fe.js";

import {
    __tla as wr
} from "./editEditor-a03e6696.js";

import {
    __tla as kr
} from "./Editor-ef737d2a.js";

import {
    __tla as Sr
} from "./type2-cee6fed1.js";

import {
    __tla as Tr
} from "./type3-da6f6f46.js";

import {
    __tla as Ir
} from "./type4-0f2e1cd1.js";

import {
    __tla as Cr
} from "./type5-a6b47fc2.js";

import {
    __tla as Er
} from "./type6-9fcada99.js";

import {
    __tla as Lr
} from "./type7-f25f20ee.js";

import {
    __tla as Nr
} from "./type30-8bfa018d.js";

import {
    __tla as Or
} from "./sqlInfo-6616efed.js";

import {
    __tla as Vr
} from "./type20-0744bc00.js";

import {
    __tla as Br
} from "./selectQuestion-d00a026c.js";

import {
    __tla as Rr
} from "./index-1024512a.js";

import "./tree-05ea8e09.js";

import {
    __tla as jr
} from "./DeptTag-1be092ce.js";

import {
    __tla as Fr
} from "./index-ef4d146e.js";

import {
    __tla as Dr
} from "./formatTime-de6f1520.js";

import {
    __tla as Mr
} from "./selectCourseResourcePackageQuestion-b7f0fe74.js";

let Ia, Ur = Promise.all([ (() => {
    try {
        return ht;
    } catch {}
})(), (() => {
    try {
        return bt;
    } catch {}
})(), (() => {
    try {
        return kt;
    } catch {}
})(), (() => {
    try {
        return Tt;
    } catch {}
})(), (() => {
    try {
        return Ct;
    } catch {}
})(), (() => {
    try {
        return Lt;
    } catch {}
})(), (() => {
    try {
        return Ot;
    } catch {}
})(), (() => {
    try {
        return Bt;
    } catch {}
})(), (() => {
    try {
        return jt;
    } catch {}
})(), (() => {
    try {
        return Dt;
    } catch {}
})(), (() => {
    try {
        return Ut;
    } catch {}
})(), (() => {
    try {
        return $t;
    } catch {}
})(), (() => {
    try {
        return At;
    } catch {}
})(), (() => {
    try {
        return Jt;
    } catch {}
})(), (() => {
    try {
        return Gt;
    } catch {}
})(), (() => {
    try {
        return er;
    } catch {}
})(), (() => {
    try {
        return ar;
    } catch {}
})(), (() => {
    try {
        return tr;
    } catch {}
})(), (() => {
    try {
        return rr;
    } catch {}
})(), (() => {
    try {
        return sr;
    } catch {}
})(), (() => {
    try {
        return lr;
    } catch {}
})(), (() => {
    try {
        return nr;
    } catch {}
})(), (() => {
    try {
        return or;
    } catch {}
})(), (() => {
    try {
        return ir;
    } catch {}
})(), (() => {
    try {
        return ur;
    } catch {}
})(), (() => {
    try {
        return pr;
    } catch {}
})(), (() => {
    try {
        return dr;
    } catch {}
})(), (() => {
    try {
        return cr;
    } catch {}
})(), (() => {
    try {
        return _r;
    } catch {}
})(), (() => {
    try {
        return mr;
    } catch {}
})(), (() => {
    try {
        return vr;
    } catch {}
})(), (() => {
    try {
        return yr;
    } catch {}
})(), (() => {
    try {
        return fr;
    } catch {}
})(), (() => {
    try {
        return hr;
    } catch {}
})(), (() => {
    try {
        return gr;
    } catch {}
})(), (() => {
    try {
        return br;
    } catch {}
})(), (() => {
    try {
        return qr;
    } catch {}
})(), (() => {
    try {
        return xr;
    } catch {}
})(), (() => {
    try {
        return Qr;
    } catch {}
})(), (() => {
    try {
        return Pr;
    } catch {}
})(), (() => {
    try {
        return wr;
    } catch {}
})(), (() => {
    try {
        return kr;
    } catch {}
})(), (() => {
    try {
        return Sr;
    } catch {}
})(), (() => {
    try {
        return Tr;
    } catch {}
})(), (() => {
    try {
        return Ir;
    } catch {}
})(), (() => {
    try {
        return Cr;
    } catch {}
})(), (() => {
    try {
        return Er;
    } catch {}
})(), (() => {
    try {
        return Lr;
    } catch {}
})(), (() => {
    try {
        return Nr;
    } catch {}
})(), (() => {
    try {
        return Or;
    } catch {}
})(), (() => {
    try {
        return Vr;
    } catch {}
})(), (() => {
    try {
        return Br;
    } catch {}
})(), (() => {
    try {
        return Rr;
    } catch {}
})(), (() => {
    try {
        return jr;
    } catch {}
})(), (() => {
    try {
        return Fr;
    } catch {}
})(), (() => {
    try {
        return Dr;
    } catch {}
})(), (() => {
    try {
        return Mr;
    } catch {}
})() ]).then(async () => {
    let O, Pe, we, ke, Se, Te, Ie, Ce, Ee, Le, Ne, Oe, Ve, Be, Re, je, Fe, De, Me, Ue, $e, ze, Ae, He, Je, Ye, Ge, Ke, Ze, We, Xe, ea, aa, ta, ra, sa, la, na, oa, ia, ua, pa, da, ca, _a, ma, va, ya;
    O = K => (yt("data-v-6af2507f"), K = K(), ft(), K), Pe = {
        class: "examContainer"
    }, we = O(() => p("span", {
        class: "ml5"
    }, "份", -1)), ke = {
        class: "library-body"
    }, Se = {
        class: "library-info"
    }, Te = {
        class: "left-box"
    }, Ie = {
        class: "left-shadow"
    }, Ce = {
        class: "info-title"
    }, Ee = {
        class: "btns-box"
    }, Le = {
        class: "info-cont"
    }, Ne = {
        key: 0,
        class: "right-box"
    }, Oe = {
        class: "info-title"
    }, Ve = {
        class: "btns-box"
    }, Be = {
        class: "pr-3 pt14"
    }, Re = O(() => p("div", {
        class: "neu-color-blue px-3 py-1"
    }, "手动选题", -1)), je = O(() => p("div", {
        class: "neu-color-blue px-3 py-1"
    }, "随机选题", -1)), Fe = {
        class: "info-cont"
    }, De = [ "id" ], Me = {
        class: "item-num"
    }, Ue = {
        key: 1,
        class: "right-box container"
    }, $e = {
        class: "container-title"
    }, ze = O(() => p("span", null, "试卷内容", -1)), Ae = {
        key: 0,
        class: "container-empty"
    }, He = O(() => p("div", {
        class: "empty-image"
    }, null, -1)), Je = {
        key: 1,
        class: "show-title"
    }, Ye = {
        class: "container-content"
    }, Ge = {
        class: "card-content-one"
    }, Ke = {
        class: "card-content-title"
    }, Ze = [ "onClick" ], We = [ "onClick" ], Xe = {
        class: "card-content-three"
    }, ea = {
        class: "card-content-item"
    }, aa = O(() => p("span", {
        class: "card-label"
    }, "题型：", -1)), ta = {
        class: "card-value"
    }, ra = {
        class: "card-content-item"
    }, sa = O(() => p("span", {
        class: "card-label"
    }, "按难易度选题：", -1)), la = {
        class: "card-value"
    }, na = {
        class: "card-content-item"
    }, oa = O(() => p("span", {
        class: "card-label"
    }, "选题数量：", -1)), ia = {
        class: "card-value"
    }, ua = {
        class: "card-content-item"
    }, pa = O(() => p("span", {
        class: "card-label"
    }, "每题分数：", -1)), da = {
        class: "card-value"
    }, ca = {
        class: "bot-box"
    }, _a = {
        key: 0
    }, ma = {
        key: 1
    }, va = {
        key: 2
    }, ya = {
        class: "algin-center"
    }, Ia = Kt({
        __name: "manuallyGroupVolumes",
        props: {
            modelValue: {
                type: Boolean,
                default: !1
            },
            form: {
                type: Object,
                default: () => ({})
            },
            isEdit: {
                type: Boolean,
                default: !1
            },
            parentId: {
                type: String,
                default: ""
            },
            inPreview: {
                type: Boolean,
                default: !1
            },
            paperCompositionType: {
                type: String,
                default: "1"
            },
            isResourcePack: {
                type: Boolean,
                default: !1
            },
            isCourseTeaching: {
                type: Boolean,
                default: !1
            }
        },
        emits: [ "update:modelValue", "submitNow", "closeDialog" ],
        setup(K, {
            expose: Ca,
            emit: Ea
        }) {
            const fa = y(null), {
                proxy: Z
            } = tt(), La = B(() => ye.value.length || 0), Na = B(() => form.value.paperState === "0"), _e = y(null), ha = rt(), P = st(), F = Ea, me = y(""), Oa = y(!1), A = y(!1), ae = y(null), I = y(!1), ga = y(), r = y({
                paperParts: [ {
                    partName: "第一大题",
                    partDesc: "",
                    paperQuestionList: []
                } ]
            }), ba = y({}), ve = y({});
            y();
            const w = y(""), W = y(""), te = y(""), re = y(!1), o = y({
                index: 0,
                type: ""
            }), H = B(() => (r.value.paperParts || [])[o.value.index] || {}), Va = y({
                name: [ {
                    required: !0,
                    message: "请输入试卷名称",
                    trigger: [ "blur" ]
                }, {
                    min: 1,
                    max: 30,
                    message: "长度在 1 到 30 个字符",
                    trigger: [ "blur" ]
                } ],
                questionType: [ {
                    required: !0,
                    message: "请选择试题类型",
                    trigger: [ "blur", "change" ]
                } ],
                randomPaperCount: [ {
                    required: !0,
                    message: "请输入组卷数量，区间为1-10",
                    trigger: [ "blur", "change" ]
                }, {
                    validator: (a, e, l) => {
                        e === "" || e === 0 ? l(new Error("请输入组卷数量，区间为1-10")) : e > 10 ? l(new Error("组卷数量不可超过10")) : l();
                    },
                    trigger: [ "blur", "change" ]
                } ]
            }), M = B(() => !!w.value);
            de(() => w.value, () => {
                w.value && U(w.value);
            });
            const x = K, se = y([]), h = lt({
                Obj: []
            }), {
                paperCompositionType: N
            } = nt(x), Ba = B(() => x.modelValue), ye = B(() => {
                let a = [];
                return (t(r).paperParts || []).forEach(e => {
                    a = a.concat(e.paperQuestionList.map(l => l.questionId || "")).filter(l => l);
                }), a;
            }), X = a => {
                switch (a.specialVariable) {
                  case !0:
                    let e = 0;
                    for (let l in a.questionRandomMap) a.questionRandomMap.hasOwnProperty(l) && (e += a.questionRandomMap[l]);
                    return e;

                  case !1:
                    return a.questionRandom;
                }
            }, Ra = () => {
                A.value = !1, ve.value = {};
            }, qa = () => {
                F("closeDialog", !1);
            }, ja = a => {
                fa.value.handleOpen(a);
            }, xa = a => {
                var l;
                let e = 0;
                return (l = h.Obj[a]) == null || l.forEach(u => {
                    e += X(u);
                }), e;
            }, Qa = a => {
                var l;
                let e = 0;
                return (l = h.Obj[a]) == null || l.forEach(u => {
                    e += parseFloat((X(u) * u.questionScore).toFixed(1));
                }), parseFloat(e.toFixed(1));
            }, Fa = B(() => {
                var e;
                let a = 0;
                return (e = h.Obj) == null || e.forEach(l => {
                    l == null || l.forEach(u => {
                        a += X(u);
                    });
                }), a;
            }), Da = B(() => {
                var e;
                let a = 0;
                return (e = h.Obj) == null || e.forEach(l => {
                    l == null || l.forEach(u => {
                        a += parseFloat((X(u) * u.questionScore).toFixed(1));
                    });
                }), parseFloat(a.toFixed(1));
            });
            de(() => r.value, () => {}, {
                immediate: !0,
                deep: !0
            }), de(() => Ba.value, a => {
                a && x.isEdit && G(() => {
                    r.value = {
                        ...x.form
                    };
                }), a && !x.isEdit && (r.value = {
                    paperParts: [ {
                        partName: "第一大题",
                        partDesc: "",
                        paperQuestionList: []
                    } ]
                }, Oa.value = !1, Z.$refs.libraryFormRef.resetFields());
            }, {
                immediate: !0
            });
            const J = y(!1), fe = y(!1), Y = y([]), le = y(!1), Ma = B(() => Y.value.length === 0 || !le.value), ne = y(!1), oe = y(!1), he = y({});
            function U(a) {
                a && document.getElementById(`question-${a}`) && document.getElementById(`question-${a}`).scrollIntoView();
            }
            function Ua(a) {
                let e = 0;
                return (H.value.paperQuestionList || []).forEach(l => {
                    e += l.paperQuestion.questionScore || l.questionScore || 0;
                }), Math.round(10 * e) / 10;
            }
            de(() => J.value, a => {
                a && (fe.value = !1);
            });
            const Pa = () => {
                I.value = !1, w.value = "", r.value = {
                    paperParts: [ {
                        partName: "第一大题",
                        partDesc: "",
                        paperQuestionList: []
                    } ]
                }, o.value = {
                    index: 0,
                    type: ""
                }, ba.value = {}, h.Obj = [], se.value = [], A.value = !1, W.value = "", 
                te.value = "", _e.value.handleBack(), Z.$refs.libraryFormRef.resetFields();
            };
            function $a() {
                I.value = !1, w.value = "", F("closeDialog", !1), F("refreshNow"), 
                r.value = {
                    paperParts: [ {
                        partName: "第一大题",
                        partDesc: "",
                        paperQuestionList: []
                    } ]
                }, o.value = {
                    index: 0,
                    type: ""
                }, ba.value = {}, h.Obj = [], se.value = [], A.value = !1, W.value = "", 
                te.value = "", _e.value.handleBack(), Z.$refs.libraryFormRef.resetFields();
            }
            const wa = () => {
                me.value = "选题规则", ae.value.handleOpen();
            }, za = a => {
                if (A.value) h.Obj[W.value] = h.Obj[W.value].map(e => e.id === te.value ? {
                    ...a
                } : e); else {
                    h.Obj[o.value.index] || (h.Obj[o.value.index] = []);
                    let e = JSON.parse(JSON.stringify(a));
                    h.Obj[o.value.index].push(Object.freeze(e));
                }
            }, Aa = async () => {
                var e;
                let a = await Z.$refs.libraryFormRef.validate();
                if (h.Obj.length > 0) {
                    if (a) {
                        let l = {
                            id: xe(x.form.id),
                            parentId: xe(x.parentId),
                            name: r.value.name,
                            tags: r.value.tags,
                            randomPaperCount: r.value.randomPaperCount,
                            paperQuestionQty: Fa.value,
                            paperScore: Da.value,
                            paperParts: []
                        };
                        (e = h.Obj) == null || e.forEach((n, c) => {
                            let i = {
                                partDesc: r.value.paperParts[c].partDesc,
                                partName: r.value.paperParts[c].partName,
                                paperRules: []
                            };
                            i.partScore = Qa(c), i.partQuestionQty = xa(c), n == null || n.forEach((_, q) => {
                                let g = {
                                    id: _.id,
                                    questionScope: _.questionScope,
                                    questionType: _.questionType,
                                    questionScore: _.questionScore,
                                    tags: _.tags,
                                    difficulty: _.specialVariable
                                };
                                [ "2" ].includes(_.questionScope) && (g.bankType = _.bankType, 
                                g.bankId = _.bankId), _.specialVariable ? g.questionRandomMap = _.questionRandomMap : g.questionRandom = _.questionRandom, 
                                i.paperRules.push(g);
                            }), l.paperParts.push(i);
                        });
                        let u = await ce.checkByRuleApi(l);
                        u.data && u.data.length > 0 ? (se.value = u.data || [], 
                        P.warning("请检查选题规则！")) : (await ce.writeQuestionsAccordingToTheRulesApi(l), 
                        P.success("操作成功！"), Pa(), F("closeDialog", !1), ha.back());
                    }
                } else P.warning("请至少填写一道选题规则！");
            }, ge = async () => new Promise((a, e) => {
                Z.$refs.libraryFormRef.validate().then(l => {
                    if (l) {
                        let u = ee();
                        u.questionNum === 0 ? (P.warning("请至少选择一道试题！"), e(new Error("试题数量为0"))) : u.questionNum > 200 ? (P.warning("试卷中试题总数不可超过200题"), 
                        e(new Error("试题数量超过限制"))) : u.partPass ? a() : (P.warning("大题内必须包含一道以上的试题！"), 
                        e(new Error("大题内试题数量不足")));
                    } else e(new Error("表单验证未通过"));
                }).catch(l => {
                    e(l);
                });
            }), ka = async (a = 0) => {
                try {
                    await ge();
                    let e = ee(), l = {
                        ...r.value,
                        id: x.form.id || "",
                        parentId: xe(x.parentId) || "",
                        syncFlag: !0,
                        folder: !1,
                        paperScore: e.score,
                        paperQuestionQty: e.questionNum,
                        paperState: a
                    };
                    await (x.isEdit ? ce.updatePaper : ce.createPaper)(l), P.success("操作成功"), 
                    x.isEdit ? F("closeDialog") : ha.back();
                } catch {}
            }, Ha = async () => {
                await ge();
                let a = ee(), e = {
                    id: r.value.id,
                    name: r.value.name,
                    paperParts: r.value.paperParts,
                    paperScore: a.score,
                    paperQuestionQty: a.questionNum,
                    tags: r.value.tags
                };
                await zt(e), P.success("操作成功"), F("closeDialog");
            }, Ja = async () => {
                await ge();
                let a = ee(), e = {
                    resId: r.value.resId,
                    paper: {
                        id: r.value.id,
                        name: r.value.name,
                        paperScore: a.score,
                        paperQuestionQty: a.questionNum,
                        tags: r.value.tags,
                        paperParts: r.value.paperParts,
                        resIsNeu: r.value.resIsNeu,
                        resPkgId: r.value.resPkgId,
                        resRootPkgId: r.value.resRootPkgId,
                        neuPkgId: r.value.neuPkgId
                    },
                    resName: r.value.name
                };
                await Yt(e), P.success("操作成功"), F("closeDialog");
            };
            function ee() {
                let a = 0, e = 0, l = !0;
                return r.value.paperParts.map(u => {
                    let n = 0, c = u.paperQuestionList || [];
                    return c.forEach(i => {
                        n += Math.round(10 * (i.paperQuestion.questionScore || i.questionScore || 0)) / 10;
                    }), e += c.length, c.length === 0 && (l = !1), Math.round(10 * n) / 10;
                }).forEach(u => {
                    a += u;
                }), {
                    score: Math.round(10 * a) / 10,
                    questionNum: e,
                    partPass: l
                };
            }
            function Ya(a) {
                switch (a) {
                  case "create":
                    return void (ne.value = !0);

                  case "random":
                    return me.value = "选题规则", void ae.value.handleOpen();

                  default:
                    return P.warning("功能开发中，敬请期待...");
                }
            }
            function Ga(a, e, l, u) {
                r.value.paperParts[o.value.index].paperQuestionList = [ ...r.value.paperParts[o.value.index].paperQuestionList || [], ...a.map(n => {
                    let c = Qe();
                    return {
                        questionId: n.id,
                        questionSource: e,
                        questionScore: Number(n.questionBody.questionType) > 5 && Number(n.questionBody.questionType) < 20 ? 10 : n.questionBody.questionType === "4" ? n.questionBody.answers.length : 2,
                        paperQuestion: {
                            ...n.questionBody,
                            questionScore: (Number(n.questionBody.questionType) > 5 && Number(n.questionBody.questionType) < 20) > 5 ? 10 : n.questionBody.questionType === "4" ? n.questionBody.answers.length : 2,
                            id: c,
                            ...n.questionBody.questionType === "4" ? {
                                answers: n.questionBody.answers.map(i => ({
                                    ...i,
                                    blankScore: 1
                                }))
                            } : {},
                            ...[ "10", "8" ].indexOf(n.questionBody.questionType) >= 0 ? {
                                subQuestions: n.questionBody.subQuestions.map(i => ({
                                    ...i,
                                    questionScore: i.subQuestion.questionType === "4" ? i.subQuestion.answers.length : 2,
                                    subQuestion: {
                                        ...i.subQuestion,
                                        questionScore: i.subQuestion.questionType === "4" ? i.subQuestion.answers.length : 2,
                                        ...i.subQuestion.questionType === "4" ? {
                                            answers: i.subQuestion.answers.map(_ => ({
                                                ..._,
                                                blankScore: 1
                                            }))
                                        } : {}
                                    }
                                }))
                            } : {}
                        },
                        questionType: n.questionBody.questionType,
                        id: c
                    };
                }) ], G(() => {
                    var n, c, i, _, q;
                    U((q = (_ = (n = r.value) == null ? void 0 : n.paperParts[o.value.index]) == null ? void 0 : _.paperQuestionList[((i = (c = r.value) == null ? void 0 : c.paperParts[o.value.index]) == null ? void 0 : i.paperQuestionList.length) - 1]) == null ? void 0 : q.id);
                });
            }
            function ie(a, e) {
                let l = a.questionScore, u = parseFloat((l / e).toFixed(1)) || .1, n = new Array(e - 1).fill(u), c = parseFloat((l - n.length * u).toFixed(1));
                return c <= 0 && (c = .1), n.push(c), n;
            }
            function Ka(a, e, l, u) {
                r.value.paperParts[o.value.index].paperQuestionList = [ ...r.value.paperParts[o.value.index].paperQuestionList || [], ...a.map(n => {
                    var i, _;
                    let c = Qe();
                    return {
                        questionId: n.id,
                        questionSource: e,
                        questionScore: n.questionScore,
                        paperQuestion: {
                            ...n.questionBody,
                            questionScore: n.questionScore,
                            id: c,
                            ...n.questionBody.questionType === "4" ? {
                                answers: (i = n.questionBody.answers) == null ? void 0 : i.map((q, g) => ({
                                    ...q,
                                    blankScore: ie(n, n.questionBody.answers.length)[g]
                                }))
                            } : {},
                            ...[ "10", "8" ].indexOf(n.questionBody.questionType) >= 0 ? {
                                subQuestions: (_ = n.questionBody.subQuestions) == null ? void 0 : _.map((q, g) => {
                                    var S;
                                    return {
                                        ...q,
                                        questionScore: n.questionBody.questionScore,
                                        subQuestion: {
                                            ...q.subQuestion,
                                            questionScore: ie(n, (S = n.questionBody.subQuestions) == null ? void 0 : S.length)[g],
                                            ...q.subQuestion.questionType === "4" ? {
                                                answers: q.subQuestion.answers.map((k, V) => {
                                                    var s, d;
                                                    return {
                                                        ...k,
                                                        blankScore: ie({
                                                            questionScore: ie(n, (s = n.questionBody.subQuestions) == null ? void 0 : s.length)[g]
                                                        }, (d = q.subQuestion.answers) == null ? void 0 : d.length)[V]
                                                    };
                                                })
                                            } : {}
                                        }
                                    };
                                })
                            } : {}
                        },
                        questionType: n.questionBody.questionType,
                        id: c
                    };
                }) ], l && l(), G(() => {
                    U(r.value.paperParts[o.value.index].paperQuestionList[r.value.paperParts[o.value.index].paperQuestionList.length - 1].id);
                });
            }
            function Za(a, e, l) {
                a.scoreList.forEach((u, n) => {
                    (r.value.paperParts[n].paperQuestionList || []).forEach(c => {
                        c.questionScore = u.score, c.paperQuestion.questionScore = u.score, 
                        function(i, _ = 2) {
                            let q = 0;
                            if (i.questionType === "4") {
                                let g = i.paperQuestion.answers || [];
                                if (g.length > 0) {
                                    let S = Math.round(_ / g.length * 10) / 10;
                                    S = Math.round(_ / g.length * 10) / 10 > .1 ? S : .1, 
                                    g.forEach((k, V) => {
                                        let s = V + 1 === g.length ? Math.round(10 * (_ - V * S)) / 10 : S;
                                        k.blankScore = s > 0 ? s : .1, q += k.blankScore;
                                    });
                                }
                                i.paperQuestion.questionScore = ue(q), i.questionScore = ue(q);
                            } else if ([ "10", "8" ].indexOf(i.questionType) >= 0) {
                                let g = i.paperQuestion.subQuestions || [];
                                if (g.length > 0) {
                                    let S = Math.round(_ / g.length * 10) / 10 || .1;
                                    g.forEach((k, V) => {
                                        let s = V + 1 === g.length ? Math.round(10 * (_ - V * S)) / 10 : S;
                                        if (k.subQuestion.questionType === "4") {
                                            let d = k.subQuestion.answers || [], f = 10 * s >= d.length ? s : d.length / 10;
                                            if (f = Math.round(10 * f) / 10, d.length > 0) {
                                                let C = Math.round(f / d.length * 10) / 10;
                                                d.forEach(($, D) => {
                                                    let z = D + 1 === d.length ? Math.round(10 * (f - D * C)) / 10 : C || .1;
                                                    $.blankScore = z;
                                                });
                                            }
                                            k.questionScore = f, k.subQuestion.questionScore = f;
                                        } else k.questionScore = s > 0 ? s : .1, 
                                        k.subQuestion.questionScore = s > 0 ? s : .1;
                                        q += k.questionScore;
                                    });
                                }
                                i.paperQuestion.questionScore = ue(q), i.questionScore = ue(q);
                            }
                        }(c, u.score), o.value.index === n && he.value[`questionRef-${c.id}`] && he.value[`questionRef-${c.id}`].initEditForm();
                    });
                }), e && e();
            }
            function ue(a) {
                return Math.round(10 * a) / 10;
            }
            function Wa(a, e) {
                w.value = a === "save" ? "" : e;
            }
            function Xa(a, e) {
                a === "remove" ? (w.value = "", r.value.paperParts[o.value.index].paperQuestionList.splice(e, 1)) : a === "prev" ? (r.value.paperParts[o.value.index].paperQuestionList = pe(r.value.paperParts[o.value.index].paperQuestionList, e, e - 1), 
                G(() => {
                    U(r.value.paperParts[o.value.index].paperQuestionList[e - 1].id);
                })) : a === "next" && (r.value.paperParts[o.value.index].paperQuestionList = pe(r.value.paperParts[o.value.index].paperQuestionList, e, e + 1), 
                G(() => {
                    var l, u, n;
                    U((n = (u = (l = r.value) == null ? void 0 : l.paperParts[o.value.index]) == null ? void 0 : u.paperQuestionList[e + 1]) == null ? void 0 : n.id);
                }));
            }
            function et(a, e) {
                w.value ? P.warning("请先保存当前处于编辑状态的试题！") : a === "remove" ? r.value.paperParts.length === 1 ? P.warning("请至少保留一道大题！") : (o.value = {
                    index: 0,
                    type: ""
                }, r.value.paperParts.splice(e, 1)) : a === "prev" ? (r.value.paperParts = pe(r.value.paperParts, e, e - 1), 
                o.value.index === e ? o.value.index = e - 1 : o.value.index + 1 === e && (o.value.index = e)) : a === "next" && (r.value.paperParts = pe(r.value.paperParts, e, e + 1), 
                o.value.index === e ? o.value.index = e + 1 : o.value.index - 1 === e && (o.value.index = e));
            }
            function pe(a, e, l) {
                if (e < 0 || e >= a.length || l < 0 || l >= a.length) return a;
                var u = a[e];
                return a[e] = a[l], a[l] = u, a;
            }
            return Ca({
                initData: Pa
            }), (a, e) => {
                var V;
                const l = pt, u = dt, n = ct, c = _t, i = mt, _ = Zt, q = Wt, g = Xt, S = vt, k = gt;
                return b(), E("div", Pe, [ m(c, {
                    ref_key: "libraryFormRef",
                    ref: ga,
                    inline: !0,
                    class: "px-5 pt-5",
                    model: t(r),
                    rules: t(Va),
                    onSubmit: e[6] || (e[6] = be(() => {}, [ "prevent" ])),
                    "label-width": "80px"
                }, {
                    default: v(() => [ m(u, {
                        label: "试卷名称",
                        prop: "name",
                        size: "large"
                    }, {
                        default: v(() => [ m(l, {
                            modelValue: t(r).name,
                            "onUpdate:modelValue": e[0] || (e[0] = s => t(r).name = s),
                            placeholder: "请输入试卷名称",
                            clearable: "",
                            style: {
                                width: "280px"
                            }
                        }, null, 8, [ "modelValue" ]) ]),
                        _: 1
                    }), [ "2" ].includes(t(N)) ? (b(), R(u, {
                        key: 0,
                        label: "随机组卷数量",
                        prop: "randomPaperCount",
                        "label-width": "120px",
                        size: "large"
                    }, {
                        default: v(() => [ m(n, {
                            modelValue: t(r).randomPaperCount,
                            "onUpdate:modelValue": e[1] || (e[1] = s => t(r).randomPaperCount = s),
                            min: 0,
                            precision: 0,
                            "controls-position": "right",
                            size: "large",
                            style: {
                                width: "100px"
                            },
                            onCompositionend: e[2] || (e[2] = s => t(qt)(s)),
                            onCompositionstart: e[3] || (e[3] = s => t(xt)(s)),
                            onKeydown: e[4] || (e[4] = s => t(Qt)(s))
                        }, null, 8, [ "modelValue" ]), we ]),
                        _: 1
                    })) : T("", !0), m(u, {
                        label: "试卷标签",
                        prop: "tags",
                        style: {
                            "margin-right": "0"
                        }
                    }, {
                        default: v(() => [ m(It, {
                            ref_key: "chooseTagsRef",
                            ref: _e,
                            modelValue: t(r).tags,
                            "onUpdate:modelValue": e[5] || (e[5] = s => t(r).tags = s),
                            tagGroupUsage: "1"
                        }, null, 8, [ "modelValue" ]) ]),
                        _: 1
                    }) ]),
                    _: 1
                }, 8, [ "model", "rules" ]), p("div", ke, [ p("div", Se, [ p("div", Te, [ p("div", Ie, [ p("div", Ce, [ Q(" 试卷大纲 "), p("div", Ee, [ m(i, {
                    type: "primary",
                    plain: "",
                    onClick: e[7] || (e[7] = s => function() {
                        let d = r.value.paperParts.length;
                        var f;
                        d !== 20 ? (r.value.paperParts.push({
                            partName: `\u7B2C${f = d, [ "一", "二", "三", "四", "五", "六", "七", "八", "九", "十", "十一", "十二", "十三", "十四", "十五", "十六", "十七", "十八", "十九", "二十", "二十一" ][f]}\u5927\u9898`,
                            partDesc: "",
                            paperQuestionList: []
                        }), o.value = {
                            index: d,
                            type: ""
                        }) : P.warning("最多可以添加20道大题！");
                    }()),
                    disabled: !!t(w),
                    icon: t(qe)
                }, {
                    default: v(() => [ Q("新增大题") ]),
                    _: 1
                }, 8, [ "disabled", "icon" ]), [ "1" ].includes(t(N)) ? (b(), R(i, {
                    key: 0,
                    plain: "",
                    onClick: e[8] || (e[8] = s => oe.value = !0),
                    disabled: !!t(w),
                    icon: t(ot)
                }, {
                    default: v(() => [ Q("批量设置分数") ]),
                    _: 1
                }, 8, [ "disabled", "icon" ])) : T("", !0) ]) ]), p("div", Le, [ m(Vt, {
                    form: t(r),
                    "onUpdate:form": e[9] || (e[9] = s => j(r) ? r.value = s : null),
                    activeInfo: t(o),
                    "onUpdate:activeInfo": e[10] || (e[10] = s => j(o) ? o.value = s : null),
                    activeId: t(w),
                    "onUpdate:activeId": e[11] || (e[11] = s => j(w) ? w.value = s : null),
                    paperCompositionType: t(N),
                    examRule: t(h).Obj,
                    onChooseQuestionIdNow: U,
                    onHandleMove: et
                }, null, 8, [ "form", "activeInfo", "activeId", "paperCompositionType", "examRule" ]) ]) ]) ]), [ "1" ].includes(t(N)) ? (b(), 
                E("div", Ne, [ p("div", Oe, [ Q(" 试卷内容 "), p("div", Ve, [ m(g, {
                    onCommand: Ya,
                    onClick: e[12] || (e[12] = be(() => {}, [ "stop" ])),
                    trigger: "click"
                }, {
                    dropdown: v(() => [ m(q, null, {
                        default: v(() => [ m(_, {
                            command: "create"
                        }, {
                            default: v(() => [ Re ]),
                            _: 1
                        }), m(_, {
                            command: "random"
                        }, {
                            default: v(() => [ je ]),
                            _: 1
                        }) ]),
                        _: 1
                    }) ]),
                    default: v(() => [ p("div", Be, [ m(i, {
                        type: "primary",
                        plain: "",
                        disabled: !!t(w) || La.value >= 200,
                        icon: t(it)
                    }, {
                        default: v(() => [ Q("题库选题") ]),
                        _: 1
                    }, 8, [ "disabled", "icon" ]) ]) ]),
                    _: 1
                }) ]) ]), p("div", Fe, [ p("div", {
                    class: "show-title px-5",
                    onClick: e[13] || (e[13] = be(s => a.changeActiveEdit(a.index, "title"), [ "stop" ]))
                }, L(H.value.partName) + " （共 " + L((H.value.paperQuestionList || []).length) + " 题，共 " + L(Ua(t(o).index)) + " 分 ）", 1), (b(!0), 
                E(Sa, null, Ta(H.value.paperQuestionList || [], (s, d) => (b(), 
                E("div", {
                    class: "item-box",
                    key: s.id,
                    id: `question-${s.id}`
                }, [ p("div", Me, L(d + 1) + ".", 1), m(Rt, {
                    ref_for: !0,
                    ref: f => ((C, $) => {
                        C && (he.value[`questionRef-${$.id}`] = C);
                    })(f, s),
                    "model-value": t(r).paperParts[t(o).index].paperQuestionList[d],
                    "onUpdate:modelValue": f => {
                        t(r).paperParts[t(o).index].paperQuestionList[d] = f;
                    },
                    length: (H.value.paperQuestionList || []).length,
                    itemIndex: d,
                    editQuestionId: t(w),
                    onViewDatabase: ja,
                    onHandleMove: Xa,
                    onHandleEdit: Wa
                }, null, 8, [ "model-value", "onUpdate:modelValue", "length", "itemIndex", "editQuestionId" ]) ], 8, De))), 128)) ]) ])) : T("", !0), [ "2" ].includes(t(N)) ? (b(), 
                E("div", Ue, [ p("div", $e, [ ze, t(h).Obj[t(o).index] && t(h).Obj[t(o).index].length !== 0 ? (b(), 
                R(i, {
                    key: 0,
                    type: "primary",
                    plain: "",
                    onClick: wa,
                    icon: t(qe)
                }, {
                    default: v(() => [ Q("新增选题规则") ]),
                    _: 1
                }, 8, [ "icon" ])) : T("", !0) ]), ((V = t(h).Obj[t(o).index]) == null ? void 0 : V.length) !== 0 && t(h).Obj[t(o).index] ? T("", !0) : (b(), 
                E("div", Ae, [ He, m(i, {
                    type: "primary",
                    onClick: wa,
                    icon: t(qe)
                }, {
                    default: v(() => [ Q("新增选题规则") ]),
                    _: 1
                }, 8, [ "icon" ]) ])), t(h).Obj[t(o).index] && t(h).Obj[t(o).index].length !== 0 ? (b(), 
                E("div", Je, L(H.value.partName) + " （共 " + L(xa(t(o).index)) + " 题，共 " + L(Qa(t(o).index)) + " 分 ）", 1)) : T("", !0), p("div", Ye, [ (b(!0), 
                E(Sa, null, Ta(t(h).Obj[t(o).index], s => {
                    var d, f, C;
                    return b(), E("div", {
                        class: ut([ "card-content", {
                            errorRule: (d = t(se)) == null ? void 0 : d.includes(s.id)
                        } ]),
                        key: s.id
                    }, [ p("div", Ge, [ p("span", Ke, L(s.questionScope === "1" ? "我的题库" : "校本题库"), 1), p("span", null, [ p("span", {
                        class: "card-btn card-edit mr10",
                        onClick: $ => ((D, z) => {
                            te.value = z.id, W.value = D, ve.value = z, A.value = !0, 
                            ae.value.handleOpen();
                        })(t(o).index, s)
                    }, [ m(S, {
                        icon: "svg-icon:card-edit"
                    }) ], 8, Ze), p("span", {
                        class: "card-btn card-del",
                        onClick: $ => {
                            return D = t(o).index, z = s.id, void (h.Obj[D] = h.Obj[D].filter((at, $r) => at.id !== z));
                            var D, z;
                        }
                    }, [ m(S, {
                        icon: "svg-icon:card-del"
                    }) ], 8, We) ]) ]), p("div", Xe, [ p("span", ea, [ aa, p("span", ta, L((C = (f = t(Pt)(t(wt).QUESTION_TYPE)) == null ? void 0 : f.find($ => s.questionType === $.value)) == null ? void 0 : C.label), 1) ]), p("span", ra, [ sa, p("span", la, L(s.specialVariable ? "是" : "否"), 1) ]), p("span", na, [ oa, p("span", ia, L(X(s)), 1) ]), p("span", ua, [ pa, p("span", da, L(s.questionScore), 1) ]) ]) ], 2);
                }), 128)) ]) ])) : T("", !0) ]) ]), p("div", ca, [ x.isResourcePack ? (b(), 
                E("div", _a, [ m(i, {
                    loading: t(I),
                    type: "primary",
                    disabled: M.value,
                    onClick: Ha
                }, {
                    default: v(() => [ Q("保存") ]),
                    _: 1
                }, 8, [ "loading", "disabled" ]), m(i, {
                    loading: t(I),
                    onClick: qa
                }, {
                    default: v(() => [ Q("返回") ]),
                    _: 1
                }, 8, [ "loading" ]) ])) : x.isCourseTeaching ? (b(), E("div", ma, [ m(i, {
                    loading: t(I),
                    type: "primary",
                    disabled: M.value,
                    onClick: Ja
                }, {
                    default: v(() => [ Q("保存") ]),
                    _: 1
                }, 8, [ "loading", "disabled" ]), m(i, {
                    loading: t(I),
                    onClick: qa
                }, {
                    default: v(() => [ Q("返回") ]),
                    _: 1
                }, 8, [ "loading" ]) ])) : (b(), E("div", va, [ !x.inPreview && [ "1" ].includes(t(N)) ? (b(), 
                R(i, {
                    key: 0,
                    loading: t(I),
                    type: "primary",
                    disabled: M.value,
                    onClick: e[14] || (e[14] = s => {
                        re.value = !0;
                    })
                }, {
                    default: v(() => [ Q("预览") ]),
                    _: 1
                }, 8, [ "loading", "disabled" ])) : T("", !0), x.inPreview && [ "1" ].includes(t(N)) ? (b(), 
                R(i, {
                    key: 1,
                    loading: t(I),
                    type: "primary",
                    disabled: M.value,
                    onClick: e[15] || (e[15] = s => (async () => {
                        let d = await ga.value.validate(), f = ee();
                        if (f.questionNum !== 0) if (f.questionNum > 200) P.warning("试卷中试题总数不可超过200题"); else if (f.partPass) {
                            if (d === !0) {
                                let C = {
                                    ...r.value,
                                    id: x.form.id || "",
                                    syncFlag: !0,
                                    folder: !1,
                                    paperScore: f.score,
                                    paperQuestionQty: f.questionNum
                                };
                                F("submitNow", C, $a, () => {
                                    I.value = !1;
                                });
                            }
                        } else P.warning("大题内必须包含一道以上的试题！"); else P.warning("请至少选择一道试题！");
                    })())
                }, {
                    default: v(() => [ Q("确定") ]),
                    _: 1
                }, 8, [ "loading", "disabled" ])) : T("", !0), !x.inPreview && [ "1" ].includes(t(N)) && Na.value ? (b(), 
                R(i, {
                    key: 2,
                    loading: t(I),
                    type: "primary",
                    disabled: M.value,
                    onClick: e[16] || (e[16] = s => ka(0))
                }, {
                    default: v(() => [ Q("保存") ]),
                    _: 1
                }, 8, [ "loading", "disabled" ])) : T("", !0), !x.inPreview && [ "1" ].includes(t(N)) ? (b(), 
                R(i, {
                    key: 3,
                    loading: t(I),
                    type: "primary",
                    disabled: M.value,
                    onClick: e[17] || (e[17] = s => ka(1))
                }, {
                    default: v(() => [ Q("完成") ]),
                    _: 1
                }, 8, [ "loading", "disabled" ])) : T("", !0), [ "2" ].includes(t(N)) ? (b(), 
                R(i, {
                    key: 4,
                    loading: t(I),
                    type: "primary",
                    disabled: M.value,
                    onClick: e[18] || (e[18] = s => Aa())
                }, {
                    default: v(() => [ Q("生成试卷") ]),
                    _: 1
                }, 8, [ "loading", "disabled" ])) : T("", !0) ])) ]), m(k, {
                    class: "entry-drawer",
                    modelValue: t(J),
                    "onUpdate:modelValue": e[23] || (e[23] = s => j(J) ? J.value = s : null),
                    title: "智能录入",
                    direction: "rtl",
                    size: "90%"
                }, {
                    footer: v(() => [ p("div", ya, [ m(i, {
                        type: "primary",
                        size: "large",
                        disabled: Ma.value,
                        loading: t(fe),
                        onClick: e[21] || (e[21] = s => (fe.value = !0, r.value.paperParts[o.value.index].paperQuestionList = (r.value.paperParts[o.value.index].paperQuestionList || []).concat(Y.value.map(d => {
                            let f = Qe();
                            return {
                                ...d,
                                paperQuestion: {
                                    questionScore: Number(d.questionType) > 5 && Number(d.questionType) < 20 ? 10 : d.questionType === "4" ? d.answers.length : 2,
                                    ...d,
                                    ...d.questionType === "4" ? {
                                        answers: d.answers.map(C => ({
                                            ...C,
                                            blankScore: 1
                                        }))
                                    } : {},
                                    id: f
                                },
                                questionId: "",
                                questionType: d.questionType,
                                questionScore: Number(d.questionType) > 5 && Number(d.questionType) < 20 ? 10 : d.questionType === "4" ? d.answers.length : 2,
                                questionSource: "",
                                id: f
                            };
                        })), Y.value = [], J.value = !1, void G(() => {
                            U(r.value.paperParts[o.value.index].paperQuestionList[r.value.paperParts[o.value.index].paperQuestionList.length - 1].id);
                        })))
                    }, {
                        default: v(() => [ Q("加入试卷") ]),
                        _: 1
                    }, 8, [ "disabled", "loading" ]), m(i, {
                        size: "large",
                        onClick: e[22] || (e[22] = s => J.value = !1)
                    }, {
                        default: v(() => [ Q("返回") ]),
                        _: 1
                    }) ]) ]),
                    default: v(() => [ m(Et, {
                        class: "batch-com pa-0",
                        modelValue: t(Y),
                        "onUpdate:modelValue": e[19] || (e[19] = s => j(Y) ? Y.value = s : null),
                        pass: t(le),
                        "onUpdate:pass": e[20] || (e[20] = s => j(le) ? le.value = s : null)
                    }, null, 8, [ "modelValue", "pass" ]) ]),
                    _: 1
                }, 8, [ "modelValue" ]), m(Ft, {
                    modelValue: t(ne),
                    "onUpdate:modelValue": e[24] || (e[24] = s => j(ne) ? ne.value = s : null),
                    onInsertQuestion: Ga,
                    questionIdList: ye.value
                }, null, 8, [ "modelValue", "questionIdList" ]), m(Mt, {
                    modelValue: t(oe),
                    "onUpdate:modelValue": e[25] || (e[25] = s => j(oe) ? oe.value = s : null),
                    onSetScoreNow: Za,
                    paperParts: t(r).paperParts || []
                }, null, 8, [ "modelValue", "paperParts" ]), x.inPreview ? T("", !0) : (b(), 
                R(Nt, {
                    key: 0,
                    modelValue: t(re),
                    "onUpdate:modelValue": e[26] || (e[26] = s => j(re) ? re.value = s : null),
                    form: t(r),
                    "is-edit": !1
                }, null, 8, [ "modelValue", "form" ])), m(St, {
                    ref_key: "randomServiceRef",
                    ref: ae,
                    editData: t(ve),
                    ruleIsEdit: t(A),
                    randomServiceTitle: t(me),
                    questionIdList: ye.value,
                    paperCompositionType: t(N),
                    onPushExamRule: za,
                    onInsertQuestion: Ka,
                    onPopUpClose: Ra
                }, null, 8, [ "editData", "ruleIsEdit", "randomServiceTitle", "questionIdList", "paperCompositionType" ]), m(Ht, {
                    ref_key: "viewDatabaseRef",
                    ref: fa
                }, null, 512) ]);
            };
        }
    }, [ [ "__scopeId", "data-v-6af2507f" ] ]);
});

export {
    Ur as __tla,
    Ia as default
};